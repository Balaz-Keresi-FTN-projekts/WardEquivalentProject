Ybusdom = [...
-180   70   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
70   -400   70   60   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   70   -400   40   0   0   0   0   0   30   0   0   0   0   0   0   0   0   0   0   60   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   60   40   -340   0   0   0   0   10   60   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   -280   0   0   0   0   0   0   70   0   10   60   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   -300   70   0   0   70   10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   70   -140   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   -180   0   0   0   0   0   20   0   70   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   10   0   0   0   0   -20   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   30   60   0   70   0   0   0   -340   0   10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   10   0   0   0   0   -120   0   0   0   50   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   70   0   0   0   0   10   0   -320   50   30   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   50   -160   0   0   0   0   0   0   0   30   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   10   0   0   20   0   0   0   30   0   -120   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   60   0   0   0   0   0   50   0   0   0   -220   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   70   0   0   0   0   0   0   0   -360   0   40   0   0   70   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   -100   0   0   40   0   0   10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   40   0   -260   0   40   50   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   -80   20   0   20   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   40   40   20   -200   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   60   0   0   0   0   0   0   0   0   0   30   0   0   70   0   50   0   0   -560   40   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   20   0   40   -140   0   0   0   10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   0   0   0   0   0   -60   0   0   0   0   20   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   -60   10   0   0   20   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   -280   0   50   0   20   0   60   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   0   0   0   -80   30   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   50   30   -380   0   0   40   0   0   70   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   20   20   0   0   0   -100   10   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   20   0   0   10   -60   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   40   0   0   -140   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   60   0   0   0   0   0   -240   60   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   60   -420   60   70   0   0   20   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   70   0   0   0   0   60   -300   0   0   0   20   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   70   0   -300   60   0   20   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   60   -180   30   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   30   -80   0   0   0   10   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   20   20   20   0   0   -220   50   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   50   -240   60   0   10   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   60   -220   0   50   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   0   0   0   -100   0   40   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   50   0   -200   40   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   40   40   -160   ];

Ywbusdom = [...
-131.712   0.132348   0   0   10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0.132348   -58.9073   0   0   0   0   20   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   -60   10   0   0   20   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   10   -280   0   50   0   20   0   60   0   0   0   0   0   0   0   0   0   0   0   ;
10   0   0   0   -80   30   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   50   30   -380   0   0   40   0   0   70   0   0   0   0   0   0   0   0   0   ;
0   20   20   0   0   0   -100   10   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   20   0   0   10   -60   0   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   40   0   0   -140   0   0   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   60   0   0   0   0   0   -240   60   0   0   0   0   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   60   -420   60   70   0   0   20   0   0   0   0   0   ;
0   0   0   0   0   70   0   0   0   0   60   -300   0   0   0   20   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   70   0   -300   60   0   20   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   60   -180   30   0   0   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   30   -80   0   0   0   10   0   0   ;
0   0   0   0   0   0   0   0   0   0   20   20   20   0   0   -220   50   0   0   0   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   50   -240   60   0   10   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   60   -220   0   50   0   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   0   0   0   -100   0   40   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   10   50   0   -200   40   ;
0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   40   40   -160   ];


Ybusdom = complex(0, Ybusdom);
Ywbusdom = complex(0, Ywbusdom);

Jinjdom = [...
	complex(-20,-2170)	;
	complex(-40,10)	;
	complex(130,-10)	;
	complex(-40,20)	;
	complex(0,0)	;
	complex(-10,40)	;
	complex(-60,0)	;
	complex(20,-30)	;
	complex(0,20)	;
	complex(-80,10)	;
	complex(0,0)	;
	complex(0,10)	;
	complex(0,0)	;
	complex(0,0)	;
	complex(-60,0)	;
	complex(60,-10)	;
	complex(0,0)	;
	complex(150,-60)	;
	complex(0,0)	;
	complex(140,-60)	;
	complex(-80,-3270)	;
	complex(0,0)	;
	complex(-50,20)	;
	complex(-30,80)	;
	complex(180,-70)	;
	complex(-10,50)	;
	complex(-60,20)	;
	complex(-50,20)	;
	complex(-80,30)	;
	complex(-50,-3280)	;
	complex(-40,40)	;
	complex(-30,20)	;
	complex(-80,20)	;
	complex(-10,30)	;
	complex(-90,30)	;
	complex(0,20)	;
	complex(-30,10)	;
	complex(0,0)	;
	complex(0,40)	;
	complex(-30,20)	;
	complex(-60,0)	;
	complex(-60,0)	];

Jwinjdom = [...
	complex(4.39505,-261.343)	;
	complex(-46.1858,17.0171)	;
	complex(-30,80)	;
	complex(180,-70)	;
	complex(-10,50)	;
	complex(-60,20)	;
	complex(-50,20)	;
	complex(-80,30)	;
	complex(-50,-3280)	;
	complex(-40,40)	;
	complex(-30,20)	;
	complex(-80,20)	;
	complex(-10,30)	;
	complex(-90,30)	;
	complex(0,20)	;
	complex(-30,10)	;
	complex(0,0)	;
	complex(0,40)	;
	complex(-30,20)	;
	complex(-60,0)	;
	complex(-60,0)	];

Yslack = [...
20  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  30  0  0  0  0  0  0  0  0  30  0  0  0  0  0  0  0  0  0  0  0  0  ];

Ywslack = [...
2.36325  0.0124499  0  0  0  0  0  0  30  0  0  0  0  0  0  0  0  0  0  0  0  ];
Yslack = complex(0, Yslack);
Ywslack = complex(0, Ywslack);

Vorig = linsolve(Ybusdom, Jinjdom);
Vw = linsolve(Ywbusdom, Jwinjdom);

slack = 1;
islack_w = Ywslack*Vw + Ywbusdom(slack,slack) * 110;
slack = 22;
islack_orig = Yslack*Vorig + Ybusdom(slack,slack) * 110;
length = 42;

Verr = (abs(Vorig(slack:length))-abs(Vw))./abs(Vorig(slack:length));
Fierr = (angle(Vorig(slack:length))-angle(Vw));
islack_err = (abs(islack_orig) - abs(islack_w))./abs(islack_orig);
islack_ang_err = (angle(islack_orig) - angle(islack_w));
